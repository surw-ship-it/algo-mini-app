<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>USDT ADS Mini App</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<script src="//libtl.com/sdk.js"
        data-zone="10483596"
        data-sdk="show_10483596"></script>

<script>
const WITHDRAW_FUNCTION_URL = "http://localhost:9999/withdraw";
</script>

<style>
body {
  margin: 0;
  padding: 0;
  background: #0f172a;
  color: #fff;
  font-family: Arial, Helvetica, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.card {
  width: 90%;
  max-width: 360px;
  background: #020617;
  border-radius: 14px;
  padding: 20px;
  text-align: center;
}
button {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  background: #2563eb;
  color: #fff;
  border: none;
  border-radius: 10px;
}
#withdrawBtn {
  margin-top: 10px;
}
#withdrawPopup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #020617;
  padding: 20px;
  border-radius: 12px;
}
#withdrawPopup input {
  width: 100%;
  padding: 10px;
  margin: 10px 0;
}
</style>
</head>

<body>

<div class="card">
  <h2>USDT ADS</h2>
  <button id="withdrawBtn">ðŸ’° Ã‡ekim Talebi</button>
</div>

<div id="withdrawPopup">
  <h3>Ã‡ekim Talebi</h3>
  <input id="walletAddress" placeholder="CÃ¼zdan adresi" />
  <button id="submitWithdraw">GÃ¶nder</button>
  <button id="cancelWithdraw">Ä°ptal</button>
</div>

<script>
if (window.Telegram?.WebApp) {
  Telegram.WebApp.ready();
}

const withdrawBtn = document.getElementById("withdrawBtn");
const popup = document.getElementById("withdrawPopup");

withdrawBtn.onclick = () => popup.style.display = "block";
cancelWithdraw.onclick = () => popup.style.display = "none";

submitWithdraw.onclick = async () => {
  const wallet = walletAddress.value.trim();
  if (!wallet) return alert("CÃ¼zdan boÅŸ");

  const tgUser = Telegram.WebApp.initDataUnsafe.user;
  if (!tgUser?.id) return alert("Telegram user yok");

  const payload = {
    telegram_id: tgUser.id,
    username: tgUser.username,
    wallet_address: wallet
  };

  const res = await fetch(WITHDRAW_FUNCTION_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  const data = await res.json();
  if (data.success) {
    alert("Ã‡ekim alÄ±ndÄ±");
    popup.style.display = "none";
  } else {
    alert("Hata");
  }
};
</script>

</body>
</html>
